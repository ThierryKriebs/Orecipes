name: Deploy to Surge

on: 
  push:
  branches: ["S1903-gh-pages-surge"]

  # DÃ©clenchement manuel depuis l'onglet " Actions " de github:
  workflow_dispatch:

permissions:
  contents: read
  
jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout du code
        uses: actions/checkout@v5.0.0

      - name: â¤ï¸ Utilisation de PNPM
        uses: pnpm/action-setup@v4
        with:
          # version: 10 a provoquÃ© une erreur chez le prof, on fait pas...
          run_install: false
        
      # PrÃ©pare l'environnement Node
      - name: âš™ï¸ Setup de l'environnement Node.js
        uses: actions/setup-node@v4
        # with:
          # node-version: 22

      # Installation des dÃ©pendances
      - name: ğŸ“¦ Installation des dÃ©pendances
        run: pnpm install

      # Lancement des tests
      - name: ğŸ§ª Lancement des tests
        run: pnpm test || echo "âš ï¸ Pas de test trouvÃ© mais le dÃ©ploiement continueâ€¦"

      # Installation de Biome (via l'action officielle)
      # â†’ https://biomejs.dev/recipes/continuous-integration
      - name: ğŸš€ Installer Biome
        uses: biomejs/setup-biome@v2
        with:
          version: latest

      # VÃ©rification du code avec Biome
      - name: ğŸ¨ ExÃ©cuter Biome pour formater et analyser le code
        run: biome ci .
        # run: biome check --apply # permet d'appliquer la correction au lieu de bloquer le dÃ©ploiement

      # Build du projet
      - name: ğŸ—ï¸ Build du projet
        run: pnpm build    

      # TÃ©lÃ©versement des fichiers construits (`dist/`) comme artefact GitHub Pages
      - name: ğŸ“¤ TÃ©lÃ©versement GitHub Pages artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: dist

          
      
    
